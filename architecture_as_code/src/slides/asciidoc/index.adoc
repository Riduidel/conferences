:icons: font
:revealjs_progress: true
:revealjs_previewLinks: true
:revealjs_mouseWheel: true
:revealjs_history: true
:revealjs_preloadIframes: true
:revealjs_plugin_notes: disabled
:customcss: custom.css
:source-highlighter: highlightjs

[%notitle]
= Architecture as code
:sectnums!:

[NOTE.speaker]
--
--

[%notitle]
== Sponsors

image::images/sponsors_snowcamp_2023.png[]

[%notitle]
== Qui suis-je ?

Nicolas Delsaux / @riduidel on https://twitter.com/riduidel[icon:twitter[]] / https://github.com/riduidel[icon:github[]] / https://stackexchange.com/users/8620[icon:stack-overflow[]]

DÃ©veloppeur Java depuis l'an 2000

Architecte de solutions/systÃ¨mes depuis 2015

image:images/snowcamp-logo.png["Kubernetes, Kafka, Elastic et Jenkins-X", height=60]
image:images/snowcamp-logo.png[Le diable s'habille en Java, height=60]
image:images/snowcamp-logo.png[C4 et au-delÃ , height=60]
image:images/snowcamp-logo.png[Architecture as code, height=60]
Snowcamps

image::images/zenika.png[height=100]

[NOTE.speaker]
--
4Ã¨me Snowcamp

Qui Ã©tait Ã  

* Kafka, kubernetes, ElasticSearch et Jenkins-X
* Le diable s'habille en Java
* *C4 et au-delÃ , documenter une architecture agilement*

Cet atelier s'appuie sur celui sur C4, pour ceux qui y Ã©taient, il y aura un peu de redite (mais pas trop)
--


== Pourquoi documenter l'architecture ?

++++
<div align=center>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Because the code is the truth, but not the whole truth.</p>&mdash; Grady Booch (@Grady_Booch) <a href="https://twitter.com/Grady_Booch/status/1253062981283221504?ref_src=twsrc%5Etfw">April 22, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 
</div>
++++

[NOTE.speaker]
--
On pourrait parler de politique dans les entreprises,
de systÃ¨mes socio-techniques, etc...
Mais en fait, c'est tellement plus simple de dire que si le code explique correctement le "comment" d'un logiciel,
il ne rÃ©pond pas Ã  quelques autres questions
--

=== A quelles questions rÃ©pondre ?

* Qui ?
* Quand ?
* Quoi ?
* [line-through]#OÃ¹ ?#
* Pourquoi ?
* [line-through]#Comment ?#

[NOTE.speaker]
--
J'ignorais que https://fr.wikipedia.org/wiki/QQOQCCP[ces questions] provenaient de la mÃ©thode aristocÃ©licienne.
En revanche, je connais l'acronyme des 5W et son usage dans le journalisme.
Et je trouve intÃ©ressant de se poser la mÃªme question Ã  propos d'un systÃ¨me logiciel, prÃ©cisÃ©ment parce qu'il s'agit d'un artefact ayant une vie impliquant des personnes aux profils divers.
--

== Mais comment documenter l'architecture ?

Voyons Ã§a Ã  travers un exemple

[NOTE.speaker]
--
C'est un atelier, donc c'est participatif.
En l'occurence, vous allez dÃ©finir et documenter l'architecture d'un systÃ¨me pour lequel je vais jouer le rÃ´le du client.
Quel systÃ¨me ?
--

=== SkibertÃ© â›·ï¸

=== A vous de jouer ðŸ“

RÃ¨gle du jeu

* 30â€™ Chaque Ã©quipe crÃ©e un (ou plusieurs) diagrammes dÃ©crivant le code dont elle sâ€™occupe
** Le facilitateur est lÃ  pour vous aider, nâ€™hÃ©sitez pas Ã  le solliciter

* Chaque Ã©quipe fournit les diffÃ©rents Ã©lÃ©ments Ã  l'Ã©quipe Ã  sa gauche
* 5â€™ chaque Ã©quipe Ã©tudie les diagrammes fournis (vous pouvez mettre des post-its contenant vos questions/interrogations/surprises)

* 5â€™ Dans chaque Ã©quipe, un membre vient montrer comment les use cases sont implÃ©mentÃ©s

[NOTE.speaker]
--
Pourquoi faire prÃ©senter par une autre Ã©quipe ?
Parce que c'est drÃ´le ?
Non. Parce que quand on demande aux gens de noter des diagrammes d'architecture, ils mettent une note de 7/10 Ã  Ã  peu prÃ¨s tout ce qu'ils voient. 
Ca n'est donc pas un bon indicateur.
Demander aux gens de restituer un diagramme qu'ils n'ont pas Ã©crit me paraÃ®t un meilleur moyen de savoir ce qu'ils en ont compris
--

[background-iframe="https://www.chronometre.fr/minuteur-30-minutes.html"]
[%notitle]
=== A vous de jouer ðŸ“ 1 - rÃ©flexion

[background-iframe="https://www.chronometre.fr/minuteur-05-minutes.html"]
[%notitle]
=== A vous de jouer ðŸ“ 2 - relecture

=== Show time ðŸŽ­

=== Comment Ã§a s'est passÃ© ?

Est-ce que vos diagrammes Ã©taient

* lÃ©gendÃ©s ? (on sait ce quâ€™est chaque patate ðŸ¥” dans le diagramme)
* consistants ? (reprÃ©sentant les mÃªmes niveaux de dÃ©tails pour les diffÃ©rents Ã©lÃ©ments visibles)
* cohÃ©rents ? (est-ce que tous les Ã©lÃ©ments prÃ©sentÃ©s avaient du sens)

=== Passons Ã  une Ã©valuation "rigoureuse"

image::images/c4model-bingo.png[width=900]

[NOTE.speaker]
--
Ce bingo a Ã©tÃ© crÃ©Ã© par Simon Brown Ã  la suite de ses nombreuses animations d'ateliers C4.
Que pensez-vous de vos diagrammes Ã  la lumiÃ¨re de cette Ã©valuation ?
--

== Comment faire mieux ?

[.columns]
=== Avec C4!

[.column]
image::images/simon_brown.png[width=500]

[.column]
* Context, Containers, Components and Code
* ImaginÃ© par Simon Brown https://twitter.com/simonbrown[icon:twitter[] @simonbrown]
* La mÃ©taphore habituelle de la carte

[transition=none]
=== C4

[cols="4*", frame=none, grid=none]
|====
.>| image:images/openstreetmap-carte-france.png[]
.>| image:images/openstreetmap-carte-savoie.png[]
.>| image:images/openstreetmap-carte-grenoble.png[]
.>| image:images/openstreetmap-carte-gare.png[]
.<| image:images/c4_SystemContext.png[]
.<| image:images/c4_Containers.png[]
.<| image:images/c4_Components.png[]
.<| image:images/c4_class-diagram.png[]
|====

[transition=none]
=== C4 - Context

[cols="25%, 75%", frame=none, grid=none]
|====
.>| image:images/openstreetmap-carte-france.png[]
.2+a|PrÃ©sente lâ€™application dans son contexte

* Liste des utilisateurs
** Ã§a nâ€™est pas un hasard si Ã§a ressemble aux user stories
* Liste des systÃ¨mes interconnectÃ©s
** MÃªme Ã  travers gravitee
** MÃªme Ã  travers Kafka
** Indiquer le type dâ€™interconnexion

.<| image:images/c4_SystemContext.png[]

|====

[transition=none]
=== C4 - Containers

[cols="25%, 25%, 50%", frame=none, grid=none]
|====
.2+|
.>| image:images/openstreetmap-carte-france.png[]
.2+a| Les conteneurs sont les Ã©lÃ©ments signifiants de lâ€™architecture

* Ce ne sont pas forcÃ©ment les conteneurs Docker de lâ€™application
* Ce ne sont pas forcÃ©ment les modules Maven/Gradle de lâ€™application
* Ce ne sont pas forcÃ©ment les WAR/EJB-JAR

.<| image:images/c4_SystemContext.png[]

|====

[transition=none]
=== C4 - Components

[cols="50%, 25%, 25%", frame=none, grid=none]
|====
.2+a|Si votre framework utilise des composants, câ€™est cool

* Spring
* Java EE
* GWT
* Swing
* VueJS
* React
* Symphony

.>| image:images/openstreetmap-carte-grenoble.png[]
.2+|
.<| image:images/c4_Components.png[]

|====


[transition=none]
=== C4 - Code

[cols="75%, 25%", frame=none, grid=none]
|====
.2+a|Est-ce quâ€™on documente son code avec un outil de documentation dâ€™architecture ? Pas forcÃ©ment

En revanche, on est capable de dÃ©finir le contexte de ce code

.>| image:images/openstreetmap-carte-gare.png[]
.<| image:images/c4_class-diagram.png[]
|====

=== A vous de jouer ðŸ“

RÃ¨gle du jeu

* 30â€™ Chaque Ã©quipe crÃ©e les diagrammes C4 dÃ©crivant le code dont elle sâ€™occupe
** Le facilitateur est lÃ  pour vous aider, nâ€™hÃ©sitez pas Ã  le solliciter

* Chaque Ã©quipe fournit les diffÃ©rents Ã©lÃ©ments Ã  l'Ã©quipe Ã  sa gauche
* 5â€™ chaque Ã©quipe Ã©tudie les diagrammes fourni (vous pouvez mettre des post-its contenant vos questions/interrogations/surprises)

* 5â€™ Dans chaque Ã©quipe, un membre vient prÃ©senter comment les use cases sont implÃ©mentÃ©s

[background-iframe="https://www.chronometre.fr/minuteur-30-minutes.html"]
[%notitle]
=== A vous de jouer ðŸ“ 1 - rÃ©flexion

[background-iframe="https://www.chronometre.fr/minuteur-05-minutes.html"]
[%notitle]
=== A vous de jouer ðŸ“ 2 - relecture

=== Show time ðŸŽ­

=== Comment Ã§a s'est passÃ© ?

Est-ce que vos diagrammes Ã©taient

* lÃ©gendÃ©s ? (on sait ce quâ€™est chaque patate ðŸ¥” dans le diagramme)
* consistants ? (reprÃ©sentant les mÃªmes niveaux de dÃ©tails pour les diffÃ©rents Ã©lÃ©ments visibles)
* cohÃ©rents ? (est-ce que tous les Ã©lÃ©ments prÃ©sentÃ©s avaient du sens)

== Comment faire mieux ?

[.columns]
=== Structurizr

[.column]
* On construit un modÃ¨le (et pas une simple â€œimageâ€)
* DSL pour les Composants (java, NET, TypeScript, PHP, python, GO)
* Simple Ã  Ã©crire
* LiÃ© au code

[.column]
image::images/structurizr_dsl.png[]

=== A nous de jouer ðŸ“

DÃ©mo time !

== Conclusion

=== Qu'est-ce qu'on a gagnÃ© ?

* Un modÃ¨le de lâ€™architecture de notre application *synchronisÃ©* avec notre code
* La capacitÃ© de produire les diagrammes standard Ã  partir du code
* La capacitÃ© de dÃ©crire aussi les diagrammes de dÃ©ploiement pour les diffÃ©rents dÃ©ploiements de lâ€™application
* La capacitÃ© d'interroger facilement ce modÃ¨le dâ€™architecture
** Produire la cartographie des flux
** Produire un inventaire des machines

=== Voir aussi

++++
<iframe width="560" height="315" src="https://www.youtube.com/embed/UzFpFQgeEyc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
++++

=== Quelques ressources

* https://structurizr.com[Structurizr]
* https://arc42.org/[Arc42]

* https://riduidel.github.io/aadarchi/[Aadarchi] (auto-promo)
* https://vistecture.me/[Vistecture]
* https://icepanel.io/[Icepanel]
* https://carbide.dev/[Carbide]

== Merci !

image::https://media.giphy.com/media/1sMH6m5alWauk/giphy.gif[width=200%]